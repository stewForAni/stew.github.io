<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>面试总结 | CoolStew</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="面试知识点记录整理">
<meta property="og:type" content="article">
<meta property="og:title" content="面试总结">
<meta property="og:url" content="https://stewforani.github.io/2015/07/05/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="CoolStew">
<meta property="og:description" content="面试知识点记录整理">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2015-07-05T09:21:33.000Z">
<meta property="article:modified_time" content="2023-06-20T14:14:34.438Z">
<meta property="article:author" content="Stew">
<meta property="article:tag" content="interview">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="CoolStew" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">CoolStew</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Android Blog &amp; Find Me Github@stewforani</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://stewforani.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-面试总结" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2015/07/05/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/" class="article-date">
  <time class="dt-published" datetime="2015-07-05T09:21:33.000Z" itemprop="datePublished">2015-07-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      面试总结
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>面试知识点记录整理</p>
<span id="more"></span>

<hr>
<h3 id="context"><a href="#context" class="headerlink" title="context"></a>context</h3><p>1.可以理解为一个环境中切换的不同场景，可以获取一些公共资源，例如资源文件，应用包信息等；可以启动 Activities, 注册广播监听器，发送广播等。<br>2.四大组件中只有 Activity，Service 继承了 Context，所以如果要算应用里的 Context 的实例数量，应该是 Activity 的实例个数 + Service 的实例个数 + Application 的实例个数。<br>3.BroadcastReceiver是没有Context的，onReceiver传进来的Context是注册该广播的Context ，而ContentProvider的Context是Application的Context。<br>4.ContextWrapper中的mBase变量是如何实例化的（分activity和application）<br>Activity:<br>ActivityThread#performLaunchActivity<br>ContextImpl appContext &#x3D; createBaseContextForActivity(r);<br>Application:<br>ActivityThread#performLaunchActivity<br>Application app &#x3D; r.packageInfo.makeApplicationInner(false, mInstrumentation);</p>
<h3 id="Handler"><a href="#Handler" class="headerlink" title="Handler"></a>Handler</h3><p>1.一个线程可以有几个Looper？<br>只能有一个，不然调用Looper.prepare()会抛出运行时异常，提示“Only one Looper may be created per thread”<br>2.一个线程可以有几个Handler<br>可以创建无数个Handler，但是他们使用的消息队列都是同一个，也就是同一个Looper<br>3.同一个Looper是怎么区分不同的Handler的，换句话说，不同的Handler是怎么做到处理自己发出的消息的？<br>handler的enqueueMessage中，msg.target &#x3D; this，最后msg.target.dispatchMessage(msg)<br>4.Thread 若与 Looper 关联，将会是一一对应的关系，且关联后关系无法改变。<br>Looper 与 MessageQueue 是一一对应的关系。<br>Handler 与 Looper 是多对一的关系，创建 Handler 实例时要么提供一个 Looper 实例，要么使用当前线程有关联的Looper。<br>5.Handler的实现原理<br>Handler:负责消息的发送和处理<br>Message:消息对象，类似于链表的一个结点<br>MessageQueue:消息队列，用于存放消息对象的数据结构<br>Looper:消息队列的处理者<br>Handler发送消息时调用MessageQueue的enqueueMessage插入一条信息到MessageQueue,Looper不断轮询调用MeaasgaQueue的next方法 如果发现message就调用handler的dispatchMessage，dispatchMessage被成功调用，接着调用handlerMessage()。<br>6.子线程中不能直接new一个Handler，因为Handler 的构造方法中，会通过Looper.myLooper()获取looper对象，如果为空，则抛出异常，主线程则因为在ActivityThread的main方法中有Looper.prepareMainLooper()<br>7.Handler导致的内存泄露原因及其解决方案<br>Java中非静态内部类和匿名内部类都会隐式持有当前类的外部引用<br>解决方案：<br>1.静态内部类 + 弱引用<br>private static class MyHandler extends Handler {<br>    &#x2F;&#x2F;弱引用，在垃圾回收时，activity可被回收<br>    private WeakReference<MainActivity> mWeakReference;<br>    public MyHandler(MainActivity activity) {<br>        mWeakReference &#x3D; new WeakReference&lt;&gt;(activity);<br>    }<br>    @Override<br>    public void handleMessage(@NonNull Message msg) {<br>        super.handleMessage(msg);<br>        &#x2F;&#x2F;之所以引用activity对象，是因为更新UI需要activity对象<br>    }<br>}<br>2.在Activity销毁时，清空Handler中未执行或正在执行的Callback以及Message：<br>protected void onDestroy() {<br>    super.onDestroy();<br>    &#x2F;&#x2F;清空handler管道和队列<br>    mHandler.removeCallbacksAndMessages(null);<br>}<br>8.Message对象创建的方式<br>Message msg &#x3D; new Message()<br>Message msg &#x3D; Message.obtain()&#x2F;&#x2F;避免重复Message创建对象<br>9.Handler的post与sendMessage的区别<br>sendMessage（适用多条件判断）<br>sendMessage-sendMessageAtTime-enqueueMessage<br>post（适用单一场景）<br>post-sendMessageDelayed-sendMessageAtTime-enqueueMessage<br>其中sendMessageDelayed中有sendMessageDelayed(getPostMessage(r), 0)<br>private static Message getPostMessage(Runnable r) {<br>    Message m &#x3D; Message.obtain();<br>    m.callback &#x3D; r;<br>    return m;<br>}<br>10.MessageQueue是什么数据结构<br>消息是按照时间先后顺序来存储的单链表<br>11.IdleHandler<br>Looper.getMainLooper().getQueue().addIdleHandler(new MessageQueue.IdleHandler() {<br>    @Override<br>    public boolean queueIdle() {<br>        &#x2F;&#x2F; UI第一帧绘制完成（可以理解为页面可见）<br>        return false;<br>    }<br>});<br>12.消息屏障<br>message.target &#x3D;&#x3D;null为屏障消息,遇到target为null的Message，说明是同步屏障，循环遍历找出一条异步消息，然后处理<br>1、Handler构造方法中传入async参数，设置为true，使用此Handler添加的Message都是异步的<br>2、创建Message对象时，直接调用setAsynchronous(true)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://stewforani.github.io/2015/07/05/%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/" data-id="clj3vrr490000cfcac37036m8" data-title="面试总结" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/interview/" rel="tag">interview</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/08/10/Android%20Expansion/libs%E5%92%8CjniLibs/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          libs和jniLibs
        
      </div>
    </a>
  
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Expansion/" rel="tag">Expansion</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Jetpack/" rel="tag">Jetpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Optimization/" rel="tag">Optimization</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/framework/" rel="tag">framework</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gradle/" rel="tag">gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/interview/" rel="tag">interview</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kotlin/" rel="tag">kotlin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rxjava/" rel="tag">rxjava</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Expansion/" style="font-size: 12px;">Expansion</a> <a href="/tags/Java/" style="font-size: 12px;">Java</a> <a href="/tags/Jetpack/" style="font-size: 14px;">Jetpack</a> <a href="/tags/Optimization/" style="font-size: 16px;">Optimization</a> <a href="/tags/algorithm/" style="font-size: 18px;">algorithm</a> <a href="/tags/android/" style="font-size: 20px;">android</a> <a href="/tags/framework/" style="font-size: 18px;">framework</a> <a href="/tags/gradle/" style="font-size: 12px;">gradle</a> <a href="/tags/interview/" style="font-size: 10px;">interview</a> <a href="/tags/kotlin/" style="font-size: 12px;">kotlin</a> <a href="/tags/rxjava/" style="font-size: 10px;">rxjava</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">October 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">July 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">June 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/01/23/Android%20Gradle/%E5%8F%91%E5%B8%83Gradle%E6%8F%92%E4%BB%B6(kotlin)/">发布Gradle插件(kotlin)</a>
          </li>
        
          <li>
            <a href="/2023/01/22/Android%20Gradle/%E5%8F%91%E5%B8%83Gradle%E6%8F%92%E4%BB%B6(java)/">发布Gradle插件(java)</a>
          </li>
        
          <li>
            <a href="/2023/01/21/Android%20Optimization/%E7%BB%84%E4%BB%B6%E5%8C%96%E7%9F%A5%E8%AF%86%E7%82%B9%E8%AE%B0%E5%BD%95/">组件化知识点记录</a>
          </li>
        
          <li>
            <a href="/2023/01/20/Android%20Gradle/Gradle%E7%9F%A5%E8%AF%86%E7%82%B9%E8%AE%B0%E5%BD%95/">Gradle知识点记录</a>
          </li>
        
          <li>
            <a href="/2022/10/26/Android%20Optimization/%E6%80%A7%E8%83%BD%E5%B7%A5%E5%85%B7/">性能工具</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 Stew<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>